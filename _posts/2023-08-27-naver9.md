---
layout: single
title: "[네이버부스트AI준비]/행렬"
categories: TIL
tag: [네이버프리코스]
toc: true
author_profile: false
sidebar:
nav: "docs"
---

# 행렬

- 행렬은 벡터를 원소로 가지는 **2차원 배열**이다

![행렬]({{site.url}}/images/2023-08-27-naver9/행렬.png){: .align-center}

위 그림에서 볼드체로 되어 있는 X1~Xn은 행벡터를 의미한다.

[전치 행렬]

행(row)와 열(column)의 인덱스 값이 바뀐 행렬을 전치 행렬이라고 한다.

## 행렬을 이해하는 방법:

1. 행렬은 **여러 점들**을 나타낸다

### 행렬 곱셈

- 행렬 곱셈은 **i 번째 행벡터와 j 번째 열벡터 사이의 내적**을 성분으로 가지는 행렬을 계산한다.

![행렬곱]({{site.url}}/images/2023-08-27-naver9/행렬곱.png){: .align-center}

**[주의!!]**

Numpy에서 X행렬과 Y행렬의 곱을 하려고 하면 X와 Y의 내적을 구하면 안되고 X와 Y.T의 내적을 구해야 한다.

2. 행렬은 **벡터 공간에서 사용되는 연산자**이다.

![연산자]({{site.url}}/images/2023-08-27-naver9/연산자.png){: .align-center}

X가 m 차원의 공간에 있었는 데 n차원으로 보내려고 할 때 행렬 곱을 통해서 **차원을 연결** 시켜 줄 수 있다.(내피셜: 느낌상으로 CNN할 때 차원을 축소 시키는 것과 유사한 느낌이라고 생각한다)
행렬곱을 통해 **패턴을 추출**할 수 있고 **데이터를 압축**할 수도 있다.

모든 선형변환은 행렬곱으로 계산할 수 있다.

### **[역행렬]**

- 어떤 행렬 A의 연산을 거꾸로 되돌리는 행렬을 **역행렬**이라 부르고 A^(-1)라 표기한다. **행과 열 숫자가 같고 행렬식(determinant)이 0이 아닌 경우**에만 계산할 수 있다.

* 만일 역행렬을 계산할 수 없다면(행과 열의 숫자가 다르다면) 유사역행렬 또는 무어 펜로즈 역행렬 A^+를 이용한다.

![유사역행렬]({{site.url}}/images/2023-08-27-naver9/유사역행렬.png){: .align-center}

```python

Y = np.array([0, 1],
             [1, -1],
             [-2, 1])

np.linalg.pinv(Y)

#출력값:

#array([[5.00000000e-01, 4.0973e-17, -5.00000000e-01],
#[8.3333333e-01, -3.333333e-01, -1.66666667e-01]])

np.linalg.pinv(Y) * Y

#출력값:
#array[[1.000000e+00, -2.22044605e-16],[0.00000000e+00, 1.00000000e+00]]
```

Y의 유사 역행렬과 Y를 곱한 결과 항등함수가 나온 것을 확인할 수 있다.

유사 역행렬을 사용하면 연립 방정식을 풀때도 사용할 수 있다.

![연립방정식]({{site.url}}/images/2023-08-27-naver9/연립방정식.png){: .align-center}

연립 방정식에서 계수들을 A 행렬이라 생각하고 변수들을 x 행렬, 그리고 해를 b행렬이라고 생각한다면, Ax = b로 표현할 수 있다.

여기서 구하고자 하는 값이 x이므로 양변에 A+를 곱하면 위 그림과 같은 식이 된다.

이와 유사하게 이를 선형회귀를 구할 때도 사용할 수 있다.

![선형회귀]({{site.url}}/images/2023-08-27-naver9/선형회귀.png){: .align-center}

선형 회귀는 y예측 값(그림에서 초록색 선의 y값)과 y 값(그림에서 빨간색) 간의 차이를 최소화 시키는 **기울기를 구하는 문제**이다.

선형회귀는 연립 방정식과는 달리 행이 더 크므로 x벡터는 y를 만족하는 x 벡터를 찾는 것은 불가능하다. 하지만 x벡터와 임의의 기울기 베타의 곱셈으로 나온 y 예측 값이 y 값과 유사하도록 만들어 줄 수 있다. y 에측 값과 y값의 차를 최소로 만들어 주는 것이다.

앞서 언급했듯이, 선형 회귀는 이 y 예측값과 y 값의 오차가 최소가 되는 기울기를 구하는 것이기 떄문에 Xb = y 식에서 양쪽에 X의 유사역행렬을 곱하여 좌변에 b만 남긴다.
