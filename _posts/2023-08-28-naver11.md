---
layout: single
title: "[네이버부스트AI준비]/선형방정식"
categories: 네이버부스트AI
tag: [Python]
toc: true
author_profile: false
sidebar:
nav: "docs"
---

# 선형 방정식

![선형방정식]({{site.url}}/images/2023-08-28-naver11/선형식.png){: .align-center}

위 방정식을 행렬과 내적을 통해 아래와 같이 표현할 수 있다는 것에 익숙해져야 한다.

![선형방정식내적]({{site.url}}/images/2023-08-28-naver11/선형식내적.png){: .align-center}

![선형방정식]({{site.url}}/images/2023-08-28-naver11/선형방정식.png){: .align-center}

## Identity Matrix(단위 행렬):

주 대각선의 원소가 모두 1이며 나머지 원소는 모두 0인 정사각 행렬을 단위 행렬이라 한다.

단위 행렬은 역행렬과 관련이 많다.

![단위행렬]({{site.url}}/images/2023-08-28-naver11/단위행렬.png){: .align-center}

## Inverse Matrix(역행렬):

**[정의]**

어떤 행렬 A와 곱했을 때 곱셈에 대한 항등원인 **단위행렬**이 되는 것을 역행렬이라 한다.

이때 일반적으로 우리가 다루는 역행렬은 N\*N인 **정사각 행렬**을 다루지만, 머신러닝 기계학습에서는 **직사각 행렬**을 다루기도 한다.(유사 역행렬)

![역행렬]({{site.url}}/images/2023-08-28-naver11/역행렬.png){: .align-center}

위 식은 주어진 행렬 2\*2가 주어졌을 때, 역행렬을 구하는 식이다.

일반적으로 모든 행렬에 대해서 역행렬이 있는 것은 아니다. 다음과 같은 조건이 만족해야 한다.

1. 정사각 행렬이어야 하며
2. determinant가 0이 되면 안된다.

이때 determinant는 판변식으로 행렬이 역행렬이 존재할 수 있는 지 없는지를 판별한다.

그럼 어떻게 판별하는 걸까?

앞에서 A행렬에 대한 역행렬은 아래와 같다는 것을 배웠다.

![역행렬1]({{site.url}}/images/2023-08-28-naver11/역행렬1.png){: .align-center}

위 식이 언제든지 성립하기 위해서는 분모인 ad-bc가 0이 되면 안된다. 이때 분모에 해당하는 것을 역행렬 유무를 판별할 수 있다 해서 determinant라고 부른다.

**[역행렬이 존재한다는 것의 의미]**

역행렬이 존재한다는 것은 해가 하나가 있다는 의미이다. 역행렬이 존재하지 않는다는 것은 반대로 해가 무수히 많거나 존재하지 않다는 것을 의미한다.

**[직각 행렬에서의 역행렬]**

임의의 행렬 A의 가로를 M, 세로를 N이라고 하자

가로보다 세로가 더 길면, 대부분의 경우 **해가 존재하지 않는다**.

반대로,

가로가 세로보다 길면, 대부분의 겨우 **해가 무수히 많이 존재한다**.

## Linear Combinations

행렬을 벡터의 표현 형식으로 바꿀 수 있다.

[행렬 표현법]

![행렬]({{site.url}}/images/2023-08-28-naver11/행렬.png){: .align-center}

[벡터 표현법]

![벡터행렬]({{site.url}}/images/2023-08-28-naver11/벡터행렬.png){: .align-center}

행렬의 곱을 행렬적으로 표현했을 때는 두 벡터의 내적으로 표현헀다면, 벡터는 좌측 행렬의 열과의 linear combination으로 볼 수 있다.

![내적]({{site.url}}/images/2023-08-28-naver11/내적.png){: .align-center}

![linearcombination]({{site.url}}/images/2023-08-28-naver11/linearcombination.png){: .align-center}

**[행렬의 곱셈 열 방향]**

1. 칼럼의 개수가 하나일 때:

![onecolumn]({{site.url}}/images/2023-08-28-naver11/onecolumn.png){: .align-center}

우측 행렬 [1, 2, 3]이 Coefficient로서 작용하는 것을 확인할 수 있다.

2. 칼럼의 개수가 여러 개일 때:

![multicolumn]({{site.url}}/images/2023-08-28-naver11/multicolumn.png){: .align-center}

우측 행렬이 Coefficient로 작동하는 것을 확인할 수 있다. X의 coefficient는 [1,2,3], Y의 coefficient는 [-1, 0, 1]이다.

**[행렬의 곱셈 행 방향]**

1. 칼럼의 개수가 하나일 때:

![onerow]({{site.url}}/images/2023-08-28-naver11/onerow.png){: .align-center}

좌측 행렬이 Coefficient로 작용하는 것을 확인할 수 있다. 1, 2, 3이 각각 [1 1 0], [1 0 1], [1 -1 1]의 Coefficient로 작용한다.

2. 칼럼의 개수가 여러 개일 때:

![multirow]({{site.url}}/images/2023-08-28-naver11/multirow.png){: .align-center}

### **[(Rank-1)외적을 이용한 행렬 곱 연산]**

![outer]({{site.url}}/images/2023-08-28-naver11/outerproduct.png){: .align-center}

위와 같은 연산은 당연하다. 여기서 더 나아가 예를 들어 [a c]와 [b d]^T의 행렬 곱을 구한다고 해보자. 결과 값은 ab+cd일 것이다. 이를 확장하면 아래와 같은 연산을 할 수 있게 된다.

![sumofrankone]({{site.url}}/images/2023-08-28-naver11/sumofrankone.png){: .align-center}

**[선형 독립 및 의존]**

![예시]({{site.url}}/images/2023-08-28-naver11/예시.png){: .align-center}

위와 같은 행렬에서 하나의 해를 가지려고 하면 어떻게 해야 할까?

하나의 해가 존재하기 위해서는 a1, a2, a3이 선형적으로 독립인 상태에 있어야 한다.

만일 무수히 많은 해가 존재한다면 a1, a2, a3은 선형적으로 의존적이라고 한다.

이를 수식으로 표현하면 다음과 같이 표현할 수 있다.

![선형의존]({{site.url}}/images/2023-08-28-naver11/선형의존.png){: .align-center}

여기서 v1~vp가 선형적으로 독립일 시, 해가 하나이다.

v1~vp가 의존적이고 마지막 xj 값이 0이 아니면, 다음 등식을 세울 수 있다.

![선형의존등식]({{site.url}}/images/2023-08-28-naver11/선형의존등식.png){: .align-center}

## 부분 공간과 기저

임의의 부분 공간 H에서 기저이기 위해 만족해야 할 조건들은 다음과 같다.

- 부분 공간 전체를 span으로 표현 가능해야 한다.
- 기저는 선형적으로 다른 기저들과 독립해야 한다.

### Column space Matrix

임의의 행렬 A의 column space는 A 행렬의 열들을 span 한 것으로 표현할 수 있다.

![columnspace]({{site.url}}/images/2023-08-28-naver11/columnspace.png){: .align-center}

여기서, 행렬들의 열중에서도 선형적으로 의존인 관계에 있는 열들이 있다.

![예시2]({{site.url}}/images/2023-08-28-naver11/예시2.png){: .align-center}

위와 같은 행렬의 dimension은 무엇일까?

A 행렬의 [2 1 1]이라는 열을 보면 앞선 열들과 선형적 의존 관계인 것을 확인 할 수 있다.

![예시3]({{site.url}}/images/2023-08-28-naver11/예시3.png){: .align-center}

이에 대한 column space를 구하면 다음과 같이 구할 수 있다.

![colspace]({{site.url}}/images/2023-08-28-naver11/colspace.png){: .align-center}

**[Rank]**

해당 column space의 dimension을 **Rank**라고 한다.
